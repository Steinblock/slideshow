@model IEnumerable<IService>
@using slideshow.core
@using System.Collections

@{
    ViewData["Title"] = "Status";
}

<h2>@ViewData["Title"]</h2>
<h3>@ViewData["Message"]</h3>

<div class="row status-content">
    <div class="col-md-4 text-right">
        <h4>HostName</h4>
    </div>
    <div class="col-md-4">
        <h4>@Environment.MachineName</h4>
    </div>
    @if (User.IsInRole("admin"))
    {
        <div class="col-md-4">
            <form method="post">
                <input type="hidden" name="name" v alue="app">
                <input class="btn btn-danger" type="submit" name="action" value="Crash me">
            </form>
        </div>
    }
</div>
<div class="row status-content">
    <div class="col-md-4 text-right">
        <h4>OSVersion</h4>
    </div>
    <div class="col-md-4">
        <h4>@Environment.OSVersion</h4>
    </div>
</div>
<div class="row status-content">
    <div class="col-md-4 text-right">
        <h4>ProcessorCount</h4>
    </div>
    <div class="col-md-4">
        <h4>@Environment.ProcessorCount</h4>
    </div>
</div>
<div class="row status-content">
    <div class="col-md-4 text-right">
        <h4>WorkingSet</h4>
    </div>
    <div class="col-md-4">
        <h4>@(Environment.WorkingSet / (1024 * 1024)) MB</h4>
    </div>
</div>

@foreach (var service in Model)
{
    <div class="row status-content">

        <div class="col-md-4 text-right">
            <h4>@service.Name</h4>
        </div>
        <div class="col-md-4">
            <h4>@service.Status</h4>
        </div>
        <div class="col-md-4">
            @if (User.IsInRole("admin"))
            {
                <form method="post">
                    <input type="hidden" name="name" value="@service.Name" />
                    @if (service.Status == ServiceStatus.Running)
                    {
                        <input class="btn btn-info" name="action" type="submit" value="Stop">
                    }
                    else if (service.Status == ServiceStatus.Stopped)
                    {
                        <input class="btn btn-info" name="action" type="submit" value="Start">
                    }
                </form>
            }

        </div>
    </div>
}

@if (User.IsInRole("admin"))
{
    <h2>Environment Variables</h2>
    @foreach (var target in Enum.GetValues(typeof(EnvironmentVariableTarget)).OfType<EnvironmentVariableTarget>().Reverse())
    {
        <h3>@target</h3>
        @foreach (DictionaryEntry envvar in Environment.GetEnvironmentVariables(target))
        {
            <div class="row status-content">
                <div class="col-md-4 text-right">
                    @envvar.Key
                </div>
                <div class="col-md-4">
                    @envvar.Value
                </div>
            </div>
        }
    }

}